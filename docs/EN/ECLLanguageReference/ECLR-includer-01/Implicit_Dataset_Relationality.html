<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Implicit Dataset Relationality</title><link rel="stylesheet" href="LN-html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.1"><link rel="home" href="index.html" title="ECL Language Reference"><link rel="up" href="Record_Structures_and_Files.html" title="Record Structures and Files"><link rel="prev" href="Temporary_SuperFiles.html" title="Temporary SuperFiles"><link rel="next" href="Alien_Data_Types.html" title="Alien Data Types"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Implicit Dataset Relationality</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="Temporary_SuperFiles.html"><img src="images/prev.gif" alt="Prev"></a>&nbsp;</td><th width="60%" align="center"><span class="bold"><strong>Record Structures and Files</strong></span></th><td width="20%" align="right">&nbsp;<a accesskey="n" href="Alien_Data_Types.html"><img src="images/next.gif" alt="Next"></a></td></tr></table><hr></div><div class="sect1" title="Implicit Dataset Relationality"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Implicit_Dataset_Relationality"></a>Implicit Dataset<a class="indexterm" name="d0e6505"></a> Relationality<a class="indexterm" name="d0e6509"></a><a class="indexterm" name="d0e6512"></a></h2></div></div></div><p>Nested child datasets<a class="indexterm" name="d0e6517"></a> in a Data Refinery (Thor) or Rapid Data Delivery Engine (Roxie) cluster are inherently relational, since all the parent-child data is contained within a single physical record. The following rules apply to all inherent relationships.</p><p>The scope level of a particular query is defined by the primary dataset for the query. During the query, the assumption is that you are working with a single record from that primary dataset.</p><p>Assuming that you have the following relational structure in your database:</p><pre class="programlisting">     Household           Parent 
        Person           Child of Household 
          Accounts       Child of Person, Grandchild of Household</pre><p>This means that, at the primary scope level:</p><p>a) All fields from any file that has a 1:M relationship with the primary file are available. That is, all fields in any parent (or grandparent, etc.) record are available to the child. For example, if the Person dataset is the primary scope, then all the fields in the Household dataset are available.</p><p>b) All child datasets (or grandchildren, etc.) can be used in sub-queries to filter the parent, as long as the sub-query uses an aggregate function or operates at the level of the existence of a set of child records that meet the filter criteria (see EXISTS).You can use specific fields from within a child record at the scope level of the parent record by the use of EVALUATE or subscripting ([]) to a specific child record. For example, if the Person dataset is the primary scope, then you may filter the set of related Accounts records and check to see if you've filtered out all the related Accounts records.</p><p>c) If a dataset is used in a scope where it is not a child of the primary dataset, it is evaluated in the enclosing scope. For example, the expression:</p><pre class="programlisting">Household(Person(personage &gt; AVE(Person,personage))</pre><p>means &#8220;households containing people whose age is above the average age for the household.&#8221; It does <span class="underline">not</span> mean &#8220;households containing people whose age is above the average for all the households.&#8221; This is because the primary dataset (Household) encloses the child dataset (Person), making the evaluation of the AVE function operate at the level of the persons within the household.</p><p>d) An attribute defined with the STORED() workflow service is evaluated at the global level. It is an error if it cannot be evaluated independently of other datasets. This can lead to some slightly strange behaviour:</p><pre class="programlisting">AveAge := AVE(Person,personage);
MyHouses := Household(Person(personage &gt; aveAge));</pre><p>means &#8220;households containing people whose age is above the average age for the household.&#8221; However,</p><pre class="programlisting">AveAge := AVE(Person,personage) : STORED('AveAge');
MyHouses := Household(Person(personage &gt; aveAge));</pre><p>Means &#8220;households containing people whose age is above the average for all the households.&#8221; This is because the AveAge attribute is now evaluated outside the enclosing Household scope.</p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="Temporary_SuperFiles.html"><img src="images/prev.gif" alt="Prev"></a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="Record_Structures_and_Files.html"><img src="images/up.gif" alt="Up"></a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="Alien_Data_Types.html"><img src="images/next.gif" alt="Next"></a></td></tr><tr><td width="40%" align="left" valign="top">Temporary SuperFiles&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html"><img src="images/home.gif" alt="Home"></a></td><td width="40%" align="right" valign="top">&nbsp;<span class="bold"><strong>Alien Data Types</strong></span></td></tr></table></div></body></html>