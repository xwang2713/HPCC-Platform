<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>ROLLUP</title><link rel="stylesheet" href="LN-html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.1"><link rel="home" href="index.html" title="ECL Language Reference"><link rel="up" href="Built-in_Functions_and_Actions.html" title="Built-in Functions and Actions"><link rel="prev" href="REJECTED.html" title="REJECTED"><link rel="next" href="TRANSFORM_Function_Requirements_Rollup.html" title="TRANSFORM Function Requirements - ROLLUP"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">ROLLUP</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="REJECTED.html"><img src="images/prev.gif" alt="Prev"></a>&nbsp;</td><th width="60%" align="center"><span class="bold"><strong>Built-in Functions and Actions</strong></span></th><td width="20%" align="right">&nbsp;<a accesskey="n" href="TRANSFORM_Function_Requirements_Rollup.html"><img src="images/next.gif" alt="Next"></a></td></tr></table><hr></div><div class="sect1" title="ROLLUP"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="ROLLUP"></a>ROLLUP</h2></div></div></div><p><span class="bold"><strong>ROLLUP<a class="indexterm" name="d0e27970"></a><a class="indexterm" name="d0e27973"></a>(</strong></span><span class="emphasis"><em>recordset, condition, transform </em></span><span class="bold"><strong>[, LOCAL<a class="indexterm" name="d0e27981"></a>] </strong></span><span class="bold"><strong>[, UNORDERED | ORDERED(</strong></span> <span class="emphasis"><em>bool </em></span><span class="bold"><strong>) ] [, STABLE | UNSTABLE ] [, PARALLEL [ (</strong></span> <span class="emphasis"><em>numthreads </em></span><span class="bold"><strong>) ] ] [, ALGORITHM(</strong></span> <span class="emphasis"><em>name </em></span><span class="bold"><strong>) ] )</strong></span></p><p><span class="bold"><strong>ROLLUP(</strong></span><span class="emphasis"><em>recordset, transform, fieldlist </em></span><span class="bold"><strong>[, LOCAL] [, UNORDERED | ORDERED(</strong></span> <span class="emphasis"><em>bool </em></span><span class="bold"><strong>) ] [, STABLE | UNSTABLE ] [, PARALLEL [ (</strong></span> <span class="emphasis"><em>numthreads </em></span><span class="bold"><strong>) ] ] [, ALGORITHM(</strong></span> <span class="emphasis"><em>name </em></span><span class="bold"><strong>) ] )</strong></span></p><p><span class="bold"><strong>ROLLUP(</strong></span><span class="emphasis"><em>recordset, </em></span><span class="bold"><strong>GROUP</strong></span><span class="emphasis"><em><a class="indexterm" name="d0e28032"></a>, transform </em></span><span class="bold"><strong>[, UNORDERED | ORDERED(</strong></span> <span class="emphasis"><em>bool </em></span><span class="bold"><strong>) ] [, STABLE | UNSTABLE ] [, PARALLEL [ (</strong></span> <span class="emphasis"><em>numthreads </em></span><span class="bold"><strong>) ] ] [, ALGORITHM(</strong></span> <span class="emphasis"><em>name </em></span><span class="bold"><strong>) ] )</strong></span></p><div class="informaltable"><table border="1"><colgroup><col width="13%"><col width="87%"></colgroup><tbody><tr><td><span class="emphasis"><em>recordset</em></span></td><td>The set of records to process, typically sorted in the same order that the condition or <span class="emphasis"><em>fieldlist</em></span> will test.</td></tr><tr><td><span class="emphasis"><em>condition</em></span></td><td>An expression that defines "duplicate" records. The keywords LEFT and RIGHT may be used as dataset qualifiers for fields in the <span class="emphasis"><em>recordset</em></span>.</td></tr><tr><td><span class="emphasis"><em>transform</em></span></td><td>The TRANSFORM function to call for each pair of duplicate records found.</td></tr><tr><td><span class="bold"><strong>LOCAL</strong></span></td><td>Optional. Specifies the operation is performed on each node independently, without requiring interaction with all other nodes to acquire data; the operation maintains the distribution of any previous DISTRIBUTE.</td></tr><tr><td><span class="emphasis"><em>fieldlist</em></span></td><td>A comma-delimited list of expressions or fields in the recordset that defines "duplicate" records. You may use the keywords WHOLE RECORD (or just RECORD) to indicate all fields in that structure, and/or you may use the keyword EXCEPT to list fields to exclude.</td></tr><tr><td><span class="bold"><strong>GROUP</strong></span></td><td>Specifies the <span class="emphasis"><em>recordset</em></span> is GROUPed and the ROLLUP operation will produce a single output record for each group. If this is not the case, an error occurs.</td></tr><tr><td><span class="bold"><strong>UNORDERED</strong></span></td><td>Optional. Specifies the output record order is not significant.</td></tr><tr><td><span class="bold"><strong>ORDERED</strong></span></td><td>Specifies the significance of the output record order.</td></tr><tr><td><span class="emphasis"><em>bool</em></span></td><td>When False, specifies the output record order is not significant. When True, specifies the default output record order.</td></tr><tr><td><span class="bold"><strong>STABLE</strong></span></td><td>Optional. Specifies the input record order is significant.</td></tr><tr><td><span class="bold"><strong>UNSTABLE</strong></span></td><td>Optional. Specifies the input record order is not significant.</td></tr><tr><td><span class="bold"><strong>PARALLEL</strong></span></td><td>Optional. Try to evaluate this activity in parallel.</td></tr><tr><td><span class="emphasis"><em>numthreads</em></span></td><td>Optional. Try to evaluate this activity using <span class="emphasis"><em>numthreads</em></span> threads.</td></tr><tr><td><span class="bold"><strong>ALGORITHM</strong></span></td><td>Optional. Override the algorithm used for this activity.</td></tr><tr><td><span class="emphasis"><em>name</em></span></td><td>The algorithm to use for this activity. Must be from the list of supported algorithms for the SORT function's STABLE and UNSTABLE options.</td></tr><tr><td>Return:</td><td>ROLLUP returns a record set.</td></tr></tbody></table></div><p>The <span class="bold"><strong>ROLLUP</strong></span> function is similar to the DEDUP function<a class="indexterm" name="d0e28171"></a> with the addition of a call to the <span class="emphasis"><em>transform</em></span> function to process each duplicate record pair. This allows you to retrieve valuable information from the "duplicate" record before it's thrown away. Depending on how you code the <span class="emphasis"><em>transform </em></span>function, ROLLUP can keep the LEFT or RIGHT record, or any mixture of data from both.</p><p>The first form of ROLLUP tests a condition using values from the records that would be passed as LEFT and RIGHT to the <span class="emphasis"><em>transform</em></span>. The records are combined if the condition is true. The second form of ROLLUP compares values from adjacent records in the input <span class="emphasis"><em>recordset</em></span>, and combines them if they are the same. These two forms will behave differently if the <span class="emphasis"><em>transform</em></span> modifies some of the fields used in the matching condition (see example below).</p><p>For the first pair of candidate records, the LEFT record passed to the transform is the first record of the pair, and the RIGHT record is the second. For subsequent matches of the same values, the LEFT record passed is the result record from the previous call to the <span class="emphasis"><em>transform</em></span> and the RIGHT record is the next record in the <span class="emphasis"><em>recordset</em></span>, as in this example:</p><pre class="programlisting">ds := DATASET([{1,10},{1,20},{1,30},{3,40},{4,50}], 
              {UNSIGNED r, UNSIGNED n});
d t(ds L, ds R) := TRANSFORM
  SELF.r := L.r + R.r;
  SELF.n := L.n + R.n;
END;
ROLLUP(ds, t(LEFT, RIGHT), r);
/* results in:
   3  60
   3  40
   4  50
*/
ROLLUP(ds, LEFT.r = RIGHT.r,t(LEFT, RIGHT));
/* results in:
   2  30
   1  30
   3  40
   4  50
   the third record is not combined because the transform modified the value.
*/</pre></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="REJECTED.html"><img src="images/prev.gif" alt="Prev"></a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="Built-in_Functions_and_Actions.html"><img src="images/up.gif" alt="Up"></a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="TRANSFORM_Function_Requirements_Rollup.html"><img src="images/next.gif" alt="Next"></a></td></tr><tr><td width="40%" align="left" valign="top">REJECTED&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html"><img src="images/home.gif" alt="Home"></a></td><td width="40%" align="right" valign="top">&nbsp;TRANSFORM Function Requirements - ROLLUP</td></tr></table></div></body></html>