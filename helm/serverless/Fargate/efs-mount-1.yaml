apiVersion: v1
kind: PersistentVolume
metadata:
  name: efs-pv
spec:
  capacity:
    storage: 5Gi
  volumeMode: Filesystem
  accessModes:
   - ReadWriteMany
  persistentVolumeReclaimPolicy: Retain
  storageClassName: efs-sc
  mountOptions:
   - tls
  csi:
    driver: efs.csi.aws.com
    volumeHandle: fs-086c14f69cb35ebdd::fsap-06b2ff58b18b9f2ab
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: efs-claim
spec:
  accessModes:
   - ReadWriteMany
  storageClassName: efs-sc
  resources:
    requests:
      storage: 5Gi
---
apiVersion: v1
kind: Pod
metadata:
  name: efs-app
spec:
  containers:
   - name: app
     image: hpccsystems/platform-core:9.0.12
     command: ['sh', '-c', 'echo "Hello, Kubernetes!" && sleep 3600']
     volumeMounts:
      - name: efs-volume
        mountPath: /var/lib/HPCCSystems/queries
  volumes:
   - name: efs-volume
     persistentVolumeClaim:
       claimName: efs-claim
